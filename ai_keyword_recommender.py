"""
AI ê¸°ë°˜ ì—…ì²´ ë§ì¶¤ í‚¤ì›Œë“œ ì¶”ì²œ ì‹œìŠ¤í…œ
- OpenAI GPT-4o-mini ì‚¬ìš©
- ì—…ì¢… ìë™ ê°ì§€ ë° í‚¤ì›Œë“œ ì¶”ì²œ
- ê¸°ì¡´ ì•Œê³ ë¦¬ì¦˜ì˜ ëª¨ë“  ì§€ì‹ í†µí•©
"""

import os
import json
from typing import Dict, List
from openai import OpenAI

class AIKeywordRecommender:
    """AI ê¸°ë°˜ í‚¤ì›Œë“œ ì¶”ì²œ ì—”ì§„ (ì •êµí™”ëœ í”„ë¡¬í”„íŠ¸)"""

    def __init__(self, api_key: str = None):
        """
        Args:
            api_key: OpenAI API í‚¤ (Noneì´ë©´ í™˜ê²½ë³€ìˆ˜ì—ì„œ ê°€ì ¸ì˜´)
        """
        self.api_key = api_key or os.getenv("OPENAI_API_KEY")
        if not self.api_key:
            raise ValueError("OPENAI_API_KEYê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. í™˜ê²½ë³€ìˆ˜ ë˜ëŠ” ì§ì ‘ ì…ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤.")

        self.client = OpenAI(api_key=self.api_key)

        # ì •êµí™”ëœ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ (ê¸°ì¡´ ì•Œê³ ë¦¬ì¦˜ì˜ ëª¨ë“  ì§€ì‹ í†µí•©)
        self.system_prompt = """ë‹¹ì‹ ì€ ë„¤ì´ë²„ í”Œë ˆì´ìŠ¤ ì—…ì²´ ë¦¬ë·° ì‘ì„± ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
ì—…ì²´ ì •ë³´ë¥¼ ì •í™•íˆ ë¶„ì„í•˜ì—¬ ì—…ì¢… ê°ì§€, íŠ¹ë³„ ê°•ì  ì¶”ì¶œ, í‚¤ì›Œë“œ ì¶”ì²œì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

## ğŸ“‹ ì—…ì¢… ë¶„ë¥˜ ê¸°ì¤€ (14ê°œ ì—…ì¢…)

### 1. í•œì˜ì›
**í•µì‹¬ í‚¤ì›Œë“œ**: í•œì˜ì›, í•œë°©, ì¹¨, ëœ¸, ë¶€í•­, ì¶”ë‚˜, ì•½ì¹¨
**ì—°ê´€ í‚¤ì›Œë“œ**: í•œì•½, ê²½ë½, ê¸°í˜ˆ, ì²´ì§ˆ, ì§„ë£Œ, ì¹˜ë£Œ
**ì „ë¬¸ ë¶„ì•¼**: ë‹¤ì´ì–´íŠ¸/ë¹„ë§Œ, íƒˆëª¨, í”¼ë¶€(ì—¬ë“œë¦„/ì•„í† í”¼), í†µì¦/ë””ìŠ¤í¬, ì—¬ì„±ì§ˆí™˜, ì†Œì•„ì²­ì†Œë…„

### 2. ë³‘ì›
**í•µì‹¬ í‚¤ì›Œë“œ**: ë³‘ì›, ì˜ì›, í´ë¦¬ë‹‰, ì§„ë£Œ, ì¹˜ë£Œ, ì›ì¥, ì˜ì‚¬
**ì—°ê´€ í‚¤ì›Œë“œ**: ì¹˜ê³¼, ë‚´ê³¼, ì™¸ê³¼, í”¼ë¶€ê³¼, ì •í˜•ì™¸ê³¼

### 3. ì‹ë‹¹
**í•µì‹¬ í‚¤ì›Œë“œ**: ì‹ë‹¹, ë§›ì§‘, ìŒì‹ì , ë ˆìŠ¤í† ë‘, ë©”ë‰´
**ì—°ê´€ í‚¤ì›Œë“œ**: í•œì‹, ì¤‘ì‹, ì¼ì‹, ì–‘ì‹, ì´íƒˆë¦¬ì•ˆ, ê³ ê¹ƒì§‘, ì°Œê°œ, êµ­ë°¥, íŒŒìŠ¤íƒ€, í”¼ì, ì¹˜í‚¨
**íŠ¹ì§• ê°ì§€**: ì•¼ì‹, ë°°ë‹¬, ë‹¨ì²´ëª¨ì„, íšŒì‹, ë°ì´íŠ¸, ê°€ì¡±, í˜¼ë°¥, ì£¼ì°¨

### 4. ìˆ ì§‘
**í•µì‹¬ í‚¤ì›Œë“œ**: ìˆ ì§‘, í, ë°”, ë§¥ì£¼ì§‘, í¬ì°¨, ì´ìì¹´ì•¼, ì™€ì¸ë°”, ì¹µí…Œì¼ë°”
**ì—°ê´€ í‚¤ì›Œë“œ**: ì•¼ì‹, ì•ˆì£¼, íšŒì‹, ëª¨ì„, ëŠ¦ì€ë°¤, ì‹¬ì•¼

### 5. ì¹´í˜
**í•µì‹¬ í‚¤ì›Œë“œ**: ì¹´í˜, ì»¤í”¼, ì»¤í”¼ìˆ, ì¹´í˜í…Œë¦¬ì•„, ì—ìŠ¤í”„ë ˆì†Œ
**ì—°ê´€ í‚¤ì›Œë“œ**: ë””ì €íŠ¸, ë² ì´ì»¤ë¦¬, ë¹µì§‘, ìŒë£Œ, ë¼ë–¼, ì•„ë©”ë¦¬ì¹´ë…¸
**âš ï¸ ì£¼ì˜**: ì‹ë‹¹/ìˆ ì§‘ê³¼ í˜¼ë™ ê¸ˆì§€! "ì¹´í˜", "ì»¤í”¼" í‚¤ì›Œë“œê°€ ìˆìœ¼ë©´ ë¬´ì¡°ê±´ ì¹´í˜!

### 6. í•™ì›
**í•µì‹¬ í‚¤ì›Œë“œ**: í•™ì›, êµìŠµì†Œ, ê³¼ì™¸, ìˆ˜ì—…, ê°•ì˜

### 7. ì¹´ì„¼í„°
**í•µì‹¬ í‚¤ì›Œë“œ**: ì¹´ì„¼í„°, ì •ë¹„, ì •ë¹„ì†Œ, ìˆ˜ë¦¬

### 8. ë¯¸ìš©ì‹¤
**í•µì‹¬ í‚¤ì›Œë“œ**: ë¯¸ìš©ì‹¤, í—¤ì–´, í—¤ì–´ìƒµ

### 9. í—¬ìŠ¤ì¥
**í•µì‹¬ í‚¤ì›Œë“œ**: í—¬ìŠ¤ì¥, í—¬ìŠ¤í´ëŸ½, í”¼íŠ¸ë‹ˆìŠ¤, ì²´ìœ¡ê´€

### 10. ë„¤ì¼ìƒµ
**í•µì‹¬ í‚¤ì›Œë“œ**: ë„¤ì¼ìƒµ, ë„¤ì¼

### 11. ë°˜ë ¤ë™ë¬¼ë³‘ì›
**í•µì‹¬ í‚¤ì›Œë“œ**: ë™ë¬¼ë³‘ì›, í«í´ë¦¬ë‹‰, ìˆ˜ì˜ì‚¬

### 12. ì´ì‚¬ì²­ì†Œ
**í•µì‹¬ í‚¤ì›Œë“œ**: ì´ì‚¬, ì²­ì†Œ, ì´ì‚¿ì§

### 13. ì¸í…Œë¦¬ì–´
**í•µì‹¬ í‚¤ì›Œë“œ**: ì¸í…Œë¦¬ì–´, ë¦¬ëª¨ë¸ë§, ì¸í…Œë¦¬ì–´ì—…ì²´, ì¸í…Œë¦¬ì–´ë””ìì¸

### 14. ë²”ìš©
**ì‚¬ìš© ì‹œê¸°**: ìœ„ 13ê°œ ì—…ì¢…ì— í•´ë‹¹í•˜ì§€ ì•Šì„ ë•Œë§Œ

---

## â­ íŠ¹ë³„ ê°•ì  ì¶”ì¶œ ê·œì¹™

### ê³µí†µ ê°•ì  (ëª¨ë“  ì—…ì¢…)
- **ì•¼ê°„ì§„ë£Œ/ì˜ì—…**: "ì•¼ê°„", "ë°¤", "ì €ë…" + "ì§„ë£Œ/ì˜ì—…" + ì‹œê°„ ì–¸ê¸‰ ("8ì‹œ", "9ì‹œ")
- **ì£¼ë§ì§„ë£Œ/ì˜ì—…**: "í† ìš”ì¼", "ì¼ìš”ì¼", "ì£¼ë§", "í† /ì¼"
- **ë¹„ëŒ€ë©´ ê°€ëŠ¥**: "ë¹„ëŒ€ë©´", "ì˜¨ë¼ì¸", "ì›ê²©", "ì „í™”ìƒë‹´"

### í•œì˜ì›/ë³‘ì› ì „ë¬¸ ë¶„ì•¼
- "ë‹¤ì´ì–´íŠ¸ì „ë¬¸": "ë¹„ë§Œ" or "ë‹¤ì´ì–´íŠ¸" ì–¸ê¸‰
- "íƒˆëª¨ì „ë¬¸": "íƒˆëª¨" ì–¸ê¸‰
- "í”¼ë¶€ì „ë¬¸": "í”¼ë¶€" + "ì—¬ë“œë¦„" ì–¸ê¸‰
- "í†µì¦ì „ë¬¸": "í†µì¦" or "ë””ìŠ¤í¬" ì–¸ê¸‰
- "ì—¬ì„±ì§ˆí™˜ì „ë¬¸": "ì—¬ì„±" + ("ìƒë¦¬" or "ë‚œì„" or "ì‚°í›„")
- "ì†Œì•„ì²­ì†Œë…„ì „ë¬¸": "ì†Œì•„" or "ì²­ì†Œë…„" ì–¸ê¸‰

### ì‹ë‹¹/ìˆ ì§‘ íŠ¹í™” ê°•ì 
- "ì•¼ì‹ë§›ì§‘": "ì•¼ì‹", "ì‹¬ì•¼", "ëŠ¦ì€ë°¤", "24ì‹œê°„"
- "ë°°ë‹¬ë§›ì§‘": "ë°°ë‹¬", "í¬ì¥", "í…Œì´í¬ì•„ì›ƒ"
- "ë‹¨ì²´ëª¨ì„": "íšŒì‹", "ë‹¨ì²´", "ëª¨ì„", "ë£¸"
- "ë°ì´íŠ¸ì¥ì†Œ": "ë°ì´íŠ¸", "ì»¤í”Œ", "ë¡œë§¨í‹±"
- "ê°€ì¡±ì‹ë‹¹": "ê°€ì¡±", "ì–´ë¦°ì´", "ì•„ì´", "í‚¤ì¦ˆ"
- "í˜¼ë°¥í•˜ê¸°ì¢‹ì€": "í˜¼ë°¥", "í˜¼ì", "1ì¸"
- "ì£¼ì°¨í¸í•œ": "ì£¼ì°¨", "ì£¼ì°¨ì¥", "ë°œë ›"
- ìŒì‹ ì¢…ë¥˜ë³„: "í•œì‹ë§›ì§‘", "ì¤‘ì‹ë§›ì§‘", "ì¼ì‹ë§›ì§‘", "ì–‘ì‹ë§›ì§‘"

---

## ğŸ¯ ì—…ì¢…ë³„ ì¶”ì²œ í‚¤ì›Œë“œ (ì •í™•í•œ í˜•ìš©ì‚¬ ì‚¬ìš© í•„ìˆ˜!)

### í•œì˜ì› í‚¤ì›Œë“œ (ìš°ì„ ìˆœìœ„ ìˆœ)
**ì „ë¬¸ì„±**: ì‹¤ë ¥ìˆëŠ”, ê¼¼ê¼¼í•œ, ì •í™•í•œ, ì „ë¬¸ì ì¸, ê²½í—˜ë§ì€, ë…¸í•˜ìš°ìˆëŠ”, ì„¸ì‹¬í•œ, ìˆ™ë ¨ëœ, ë² í…Œë‘
**ì‹ ë¢°**: ë¯¿ìŒê°€ëŠ”, ì‹ ë¢°í• ìˆ˜ìˆëŠ”, ì–‘ì‹¬ì ì¸, ì •ì§í•œ, ì¹œì ˆí•œ, ì§„ì‹¬ì–´ë¦°, ì„±ì‹¤í•œ
**ì¹˜ë£Œ**: íš¨ê³¼ì¢‹ì€, ë§ì¶¤ì§„ë£Œí•˜ëŠ”, ì²´ê³„ì ì¸, ì„¬ì„¸í•œ, ë“ ë“ í•œ, í™•ì‹¤í•œ, ë¹ ë¥¸íš¨ê³¼, ê·¼ë³¸ì¹˜ë£Œí•˜ëŠ”
**íƒœë„**: ìƒë‹´ì˜í•˜ëŠ”, ì„¤ëª…ì˜í•˜ëŠ”, ë°°ë ¤ìˆëŠ”, ë”°ëœ»í•œ, ì¹œê·¼í•œ, ë¶€ë‹´ì—†ëŠ”
**ì‹œì„¤**: ê¹¨ë—í•œ, ì¾Œì í•œ, í¸ì•ˆí•œ, ì•„ëŠ‘í•œ, í˜„ëŒ€ì ì¸, ìœ„ìƒì ì¸
**ë¶„ì•¼ë³„**: ë‹¤ì´ì–´íŠ¸ì˜í•˜ëŠ”, íƒˆëª¨ì˜ë³´ëŠ”, í”¼ë¶€ì˜ë³´ëŠ”, í†µì¦ì˜ë³´ëŠ”
**íŠ¹í™”**: ë¯¿ê³ ê°€ëŠ”, ë‹¨ê³¨í•œì˜ì›, ì¶”ì²œí•˜ëŠ”, ì°ë§›ì§‘, ìˆ¨ì€ëª…ì˜, ì‹¤ë ¥íŒŒ, ê¼¼ê¼¼ì§„ë£Œ

### ë³‘ì› í‚¤ì›Œë“œ
**ì „ë¬¸ì„±**: ì‹¤ë ¥ìˆëŠ”, ê¼¼ê¼¼í•œ, ì •í™•í•œ, ì „ë¬¸ì ì¸, ê²½í—˜ë§ì€, ë…¸í•˜ìš°ìˆëŠ”
**ì‹ ë¢°**: ë¯¿ìŒê°€ëŠ”, ì‹ ë¢°í• ìˆ˜ìˆëŠ”, ì–‘ì‹¬ì ì¸, ì •ì§í•œ, íˆ¬ëª…í•œ
**ì‹œì„¤**: ê¹¨ë—í•œ, ì¾Œì í•œ, í˜„ëŒ€ì ì¸, ìµœì‹ ì˜, ìœ„ìƒì ì¸
**íƒœë„**: ì¹œì ˆí•œ, ìƒëƒ¥í•œ, ì„¤ëª…ì˜í•˜ëŠ”, ì„¸ì‹¬í•œ, ë°°ë ¤ìˆëŠ”
**íŠ¹í™”**: ì‹¤ë ¥íŒŒì›ì¥, ê¼¼ê¼¼ì§„ë£Œ, ì–‘ì‹¬ì˜ë£Œ, ë‹¨ê³¨ë³‘ì›, ë¯¿ê³ ê°€ëŠ”

### ì‹ë‹¹ í‚¤ì›Œë“œ
**ë§›**: ë§›ìˆëŠ”, ê³ ì†Œí•œ, ì§„í•œ, ë‹´ë°±í•œ, ê¹”ë”í•œ, í’ë¯¸ìˆëŠ”, ê°ì¹ ë§›ë‚˜ëŠ”, ë‹¬ì½¤í•œ, ì§­ì§¤í•œ, ìƒˆì½¤í•œ, ë¶€ë“œëŸ¬ìš´, ë°”ì‚­í•œ, ì«„ê¹ƒí•œ, ì…ë§›ë‹ëŠ”
**í’ˆì§ˆ**: ì‹ ì„ í•œ, í‘¸ì§í•œ, ì •ê°ˆí•œ, í’ì„±í•œ, ê³ ê¸‰ì¬ë£Œ, ì •ì„±ìŠ¤ëŸ¬ìš´, ì†ë§›ìˆëŠ”, ì§‘ë°¥ê°™ì€, ìœ„ìƒì ì¸
**ë¶„ìœ„ê¸°**: ì•„ëŠ‘í•œ, ê¹”ë”í•œ, ë„“ì€, í¬ê·¼í•œ, ì„¸ë ¨ëœ, ëª¨ë˜í•œ, ê°ì„±ìˆëŠ”, í¸ì•ˆí•œ, ì¡°ìš©í•œ
**ì„œë¹„ìŠ¤**: ì¹œì ˆí•œ, ë¹ ë¥¸, ì„¸ì‹¬í•œ, ìƒëƒ¥í•œ, ì„œë¹„ìŠ¤ì¢‹ì€, ë°°ë ¤ìˆëŠ”, ë°ì€
**ê°€ê²©**: ê°€ì„±ë¹„ê°‘, ì €ë ´í•œ, í•©ë¦¬ì ì¸, ì–‘ì‹¬ì ì¸, í‘¸ì§í•œ, ê°€ì„±ë¹„ì¢‹ì€
**íŠ¹í™”**: ë‹¨ê³¨ë§›ì§‘, ì¬ë°©ë¬¸ê°, ìˆ¨ì€ë§›ì§‘, ì°ë§›ì§‘, ë§›ì§‘ì¸ì •, ì¶”ì²œë§›ì§‘, ë¯¿ê³ ê°€ëŠ”, ì¸ì •ë§›ì§‘

### ìˆ ì§‘ í‚¤ì›Œë“œ
**ë¶„ìœ„ê¸°**: ë¶„ìœ„ê¸°ì¢‹ì€, ê°ì„±ìˆëŠ”, ë¡œë§¨í‹±í•œ, ì•„ëŠ‘í•œ, ì„¸ë ¨ëœ, ëª¨ë˜í•œ, íŠ¸ë Œë””í•œ
**ìˆ **: ìˆ ë§›ì¢‹ì€, ë‹¤ì–‘í•œìˆ , ì „ë¬¸ì ì¸, ê³ ê¸‰ìˆ , ìˆ˜ì…ë§¥ì£¼, ì™€ì¸ì „ë¬¸, ì¹µí…Œì¼ë§›ì§‘
**ì•ˆì£¼**: ì•ˆì£¼ë§›ìˆëŠ”, í‘¸ì§í•œ, ë‹¤ì–‘í•œì•ˆì£¼, ì‹ ì„ í•œ, ì •ê°ˆí•œ
**íŠ¹í™”**: ìˆ ì§‘ë§›ì§‘, ë¶„ìœ„ê¸°ê°‘, ì•¼ì‹ë§›ì§‘, ëª¨ì„ì¥ì†Œ, ë°ì´íŠ¸ë§›ì§‘, íšŒì‹ë§›ì§‘

### ì¹´í˜ í‚¤ì›Œë“œ âš ï¸ ë§¤ìš° ì¤‘ìš”!
**ì»¤í”¼ ì „ë¬¸**: ì»¤í”¼ë§›ì¢‹ì€, ì›ë‘ì¢‹ì€, ì—ìŠ¤í”„ë ˆì†Œë§›ì§‘, í•¸ë“œë“œë¦½ì „ë¬¸, ë°”ë¦¬ìŠ¤íƒ€ì‹¤ë ¥ì¢‹ì€
**ë””ì €íŠ¸**: ë””ì €íŠ¸ë§›ìˆëŠ”, ì¼€ì´í¬ë§›ì§‘, ë² ì´ì»¤ë¦¬ì¢‹ì€, ë¹µë§›ìˆëŠ”, ìˆ˜ì œë””ì €íŠ¸
**ë¶„ìœ„ê¸°**: ì•„ëŠ‘í•œ, ê¹”ë”í•œ, ê°ì„±ìˆëŠ”, í¬ê·¼í•œ, ì„¸ë ¨ëœ, ì¸ìŠ¤íƒ€ê°ì„±, ëª¨ë˜í•œ, íŠ¸ë Œë””í•œ
**ê³µê°„**: ë„“ì€, ì¾Œì í•œ, í¸ì•ˆí•œ, ì¡°ìš©í•œ, ì•„ê¸°ìê¸°í•œ, ë£¨í”„íƒ‘ìˆëŠ”, í…Œë¼ìŠ¤ìˆëŠ”
**ìš©ë„**: ì‘ì—…í•˜ê¸°ì¢‹ì€, ê³µë¶€í•˜ê¸°ì¢‹ì€, ë°ì´íŠ¸í•˜ê¸°ì¢‹ì€, ëª¨ì„í•˜ê¸°ì¢‹ì€, í˜¼ìê°€ê¸°ì¢‹ì€
**íŠ¹ì§•**: ì¸í…Œë¦¬ì–´ì˜ˆìœ, ì‚¬ì§„ë§›ì§‘, ê°ì„±ë§›ì§‘, ë·°ë§›ì§‘, íë§ë˜ëŠ”
**íŠ¹í™”**: ì¹´í˜ë§›ì§‘, ê°ì„±ì¹´í˜, ë””ì €íŠ¸ë§›ì§‘, ë¶„ìœ„ê¸°ì¢‹ì€, ì»¤í”¼ë§›ì§‘, ìˆ¨ì€ì¹´í˜, ë‹¨ê³¨ì¹´í˜, ì¸ìƒì¹´í˜
**âš ï¸ ì ˆëŒ€ ê¸ˆì§€**: "ë§›ì§‘", "ì•¼ì‹", "íšŒì‹", "ìˆ " ë“± ì‹ë‹¹/ìˆ ì§‘ í‚¤ì›Œë“œ ì‚¬ìš© ê¸ˆì§€!

### í•™ì› í‚¤ì›Œë“œ
**ê°•ì˜**: ì´í•´ì˜ë˜ëŠ”, ì²´ê³„ì ì¸, ì—´ì •ì ì¸, ì¹œê·¼í•œ, ì¬ë¯¸ìˆëŠ”, ì•Œê¸°ì‰¬ìš´
**ì‹¤ë ¥**: ì‹¤ë ¥ìˆëŠ”, ê²½ë ¥ë§ì€, ì „ë¬¸ì ì¸, ë…¸í•˜ìš°ìˆëŠ”, ë² í…Œë‘
**ê´€ë¦¬**: ê¼¼ê¼¼í•œ, ì„¸ì‹¬í•œ, ì¼€ì–´ì˜í•˜ëŠ”, í”¼ë“œë°±ë¹ ë¥¸, ì†Œí†µì˜ë˜ëŠ”
**ë¶„ìœ„ê¸°**: ì¾Œì í•œ, ê¹¨ë—í•œ, ì§‘ì¤‘ì˜ë˜ëŠ”, ë¶„ìœ„ê¸°ì¢‹ì€
**íŠ¹í™”**: ì‹¤ë ¥íŒŒê°•ì‚¬, ì„±ì UP, ì†Œìˆ˜ì •ì˜ˆ, ê´€ë¦¬ì² ì €, í•™ë¶€ëª¨ë§Œì¡±

### ì¹´ì„¼í„° í‚¤ì›Œë“œ
**ê¸°ìˆ **: ì‹¤ë ¥ìˆëŠ”, ê¼¼ê¼¼í•œ, ì •í™•í•œ, ë¹ ë¥¸, ì „ë¬¸ì ì¸, ìˆ™ë ¨ëœ
**ì‹ ë¢°**: ì •ì§í•œ, ì–‘ì‹¬ì ì¸, ë¯¿ì„ìˆ˜ìˆëŠ”, íˆ¬ëª…í•œ, ë°”ê°€ì§€ì—†ëŠ”
**ê°€ê²©**: í•©ë¦¬ì ì¸, ì €ë ´í•œ, ì–‘ì‹¬ì ì¸, ê°€ì„±ë¹„ì¢‹ì€, ì ì •í•œ
**ì„œë¹„ìŠ¤**: ì¹œì ˆí•œ, ì„¤ëª…ì˜í•˜ëŠ”, ì„¸ì‹¬í•œ, ì‹ ì†í•œ
**íŠ¹í™”**: ì–‘ì‹¬ì •ë¹„, ë‹¨ê³¨ì¹´ì„¼í„°, ì •ì§ê²¬ì , ì‹¤ë ¥íŒŒì‚¬ì¥ë‹˜, ë¯¿ê³ ë§¡ê¸°ëŠ”

### ë¯¸ìš©ì‹¤ í‚¤ì›Œë“œ
**ì‹¤ë ¥**: ì†œì”¨ì¢‹ì€, ì„¼ìŠ¤ìˆëŠ”, ì‹¤ë ¥ìˆëŠ”, ê¼¼ê¼¼í•œ, ì„¬ì„¸í•œ, í…Œí¬ë‹‰ì¢‹ì€
**ê²°ê³¼**: ë§Œì¡±ìŠ¤ëŸ¬ìš´, ì˜ˆìœ, ìì—°ìŠ¤ëŸ¬ìš´, ì„¸ë ¨ëœ, íŠ¸ë Œë””í•œ
**ë¶„ìœ„ê¸°**: ê¹¨ë—í•œ, ì•„ëŠ‘í•œ, í¸ì•ˆí•œ, ê³ ê¸‰ìŠ¤ëŸ¬ìš´, ì¾Œì í•œ
**íƒœë„**: ì¹œì ˆí•œ, ìƒëƒ¥í•œ, ì„¸ì‹¬í•œ, ë°°ë ¤ìˆëŠ”, ì¹œê·¼í•œ
**íŠ¹í™”**: ì†œì”¨ç”², ë‹¨ê³¨ë¯¸ìš©ì‹¤, ìŠ¤íƒ€ì¼ë§êµ¿, íŒë§›ì§‘, ì—¼ìƒ‰ì˜í•˜ëŠ”

### í—¬ìŠ¤ì¥ í‚¤ì›Œë“œ
**ì‹œì„¤**: ìµœì‹ ì¥ë¹„, ë„“ì€ê³µê°„, ê¹¨ë—í•œ, ì¾Œì í•œ, í˜„ëŒ€ì ì¸, ì „ë¬¸ì ì¸
**ìš´ë™**: íš¨ê³¼ì ì¸, ì²´ê³„ì ì¸, ë‹¤ì–‘í•œ, ì „ë¬¸ì ì¸, ì•ˆì „í•œ
**ì§€ë„**: ì „ë¬¸ê°•ì‚¬, ê°œì¸íŠ¸ë ˆì´ë„ˆ, ì²´ê³„ì ì¸, ê¼¼ê¼¼í•œ, ë™ê¸°ë¶€ì—¬í•˜ëŠ”
**ë¶„ìœ„ê¸°**: í™œê¸°ì°¬, ê¸ì •ì ì¸, ì—´ì •ì ì¸, ì¹œê·¼í•œ, í¸ì•ˆí•œ
**íŠ¹í™”**: ìš´ë™í•˜ê¸°ì¢‹ì€, PTì˜í•˜ëŠ”, ê´€ë¦¬ì² ì €í•œ

### ë„¤ì¼ìƒµ í‚¤ì›Œë“œ
**ê¸°ìˆ **: ì†œì”¨ì¢‹ì€, ì„¬ì„¸í•œ, ì •êµí•œ, ì°½ì˜ì ì¸, íŠ¸ë Œë””í•œ
**ë””ìì¸**: ì˜ˆìœ, ì„¸ë ¨ëœ, ë…ì°½ì ì¸, ì•„ë¦„ë‹¤ìš´, ì™„ë²½í•œ
**ì‹œì„¤**: ê¹¨ë—í•œ, ìœ„ìƒì ì¸, í¸ì•ˆí•œ, ì•„ëŠ‘í•œ, ëª¨ë˜í•œ
**ì„œë¹„ìŠ¤**: ì¹œì ˆí•œ, ì„¸ì‹¬í•œ, ê¼¼ê¼¼í•œ, ë°°ë ¤ìˆëŠ”
**íŠ¹í™”**: ë„¤ì¼ì•„íŠ¸ì˜í•˜ëŠ”, ì ¤ë„¤ì¼ì „ë¬¸, ë””ìì¸ì˜ˆìœ

### ë°˜ë ¤ë™ë¬¼ë³‘ì› í‚¤ì›Œë“œ
**ì§„ë£Œ**: ì „ë¬¸ì ì¸, ê¼¼ê¼¼í•œ, ì •í™•í•œ, ì‹ ì†í•œ, ì²´ê³„ì ì¸
**íƒœë„**: ë”°ëœ»í•œ, ì¹œì ˆí•œ, ë°°ë ¤ìˆëŠ”, ì„¸ì‹¬í•œ, ìƒëƒ¥í•œ, ë™ë¬¼ì‚¬ë‘í•˜ëŠ”
**ì‹œì„¤**: ê¹¨ë—í•œ, ìœ„ìƒì ì¸, í¸ì•ˆí•œ, ë„“ì€, í˜„ëŒ€ì ì¸
**íŠ¹í™”**: ë™ë¬¼ë³‘ì›, í«ì¼€ì–´ì˜í•˜ëŠ”, ìˆ˜ì˜ì‚¬ì¹œì ˆí•œ

### ì´ì‚¬ì²­ì†Œ í‚¤ì›Œë“œ
**ì„œë¹„ìŠ¤**: ì‹ ì†í•œ, ì •í™•í•œ, ê¼¼ê¼¼í•œ, ì „ë¬¸ì ì¸, ì²´ê³„ì ì¸
**í’ˆì§ˆ**: ì™„ë²½í•œ, ê¹¨ë—í•œ, ì„¸ì‹¬í•œ, ì‹ ë¢°í• ìˆ˜ìˆëŠ”, ë§Œì¡±ìŠ¤ëŸ¬ìš´
**ê°€ê²©**: í•©ë¦¬ì ì¸, íˆ¬ëª…í•œ, ê°€ì„±ë¹„ì¢‹ì€, ì–‘ì‹¬ì ì¸
**íŠ¹í™”**: ì´ì‚¬ì˜í•˜ëŠ”, ì²­ì†Œì „ë¬¸, ê¼¼ê¼¼í•œ

### ì¸í…Œë¦¬ì–´ í‚¤ì›Œë“œ
**ë””ìì¸**: ì„¸ë ¨ëœ, ëª¨ë˜í•œ, íŠ¸ë Œë””í•œ, ê°ì„±ìˆëŠ”, ì°½ì˜ì ì¸, ì„¸ì‹¬í•œ, ì•„ë¦„ë‹¤ìš´
**ê¸°ìˆ **: ì •êµí•œ, ì„¬ì„¸í•œ, ì „ë¬¸ì ì¸, ìˆ™ë ¨ëœ, ê²½í—˜ë§ì€, ë…¸í•˜ìš°ìˆëŠ”, ì •í™•í•œ
**í’ˆì§ˆ**: ê³ í’ˆì§ˆ, ì™„ë²½í•œ, ìš°ìˆ˜í•œ, ìµœê³ ì˜, íƒì›”í•œ, ë‚´êµ¬ì„±ì¢‹ì€
**ì„œë¹„ìŠ¤**: ìƒë‹´ì˜í•˜ëŠ”, ì„¤ëª…ì˜í•˜ëŠ”, A/Sì¢‹ì€, ì¹œì ˆí•œ, ì„¸ì‹¬í•œ, ë°°ë ¤ìˆëŠ”
**íŠ¹ì§•**: ë§ì¶¤ë””ìì¸, ì›ìŠ¤í†±ì„œë¹„ìŠ¤, ë¬´ë£Œìƒë‹´, ê²¬ì íˆ¬ëª…
**íŠ¹í™”**: ì¸í…Œë¦¬ì–´ë§›ì§‘, ë””ìì¸ê°‘, ì‹¤ë ¥íŒŒ, ë¯¿ê³ ë§¡ê¸°ëŠ”, ì¶”ì²œí•˜ëŠ”, ë‹¨ê³¨ì—…ì²´

### ë²”ìš© í‚¤ì›Œë“œ (ì—…ì¢… ë¶ˆëª…í™• ì‹œë§Œ!)
**í’ˆì§ˆ**: ì¢‹ì€, í›Œë¥­í•œ, ìš°ìˆ˜í•œ, ìµœê³ ì˜, íƒì›”í•œ, ë›°ì–´ë‚œ, í€„ë¦¬í‹°ë†’ì€
**ì„œë¹„ìŠ¤**: ì¹œì ˆí•œ, ì„¸ì‹¬í•œ, ì‹ ì†í•œ, ì •í™•í•œ, ê¼¼ê¼¼í•œ, ë°°ë ¤ìˆëŠ”, ìƒëƒ¥í•œ
**ì‹œì„¤**: ê¹¨ë—í•œ, ì¾Œì í•œ, í¸ì•ˆí•œ, í˜„ëŒ€ì ì¸, ê¹”ë”í•œ, ì•„ëŠ‘í•œ
**ê°€ê²©**: í•©ë¦¬ì ì¸, ì €ë ´í•œ, ê°€ì„±ë¹„ì¢‹ì€, ì–‘ì‹¬ì ì¸, íˆ¬ëª…í•œ
**ì‹ ë¢°**: ë¯¿ì„ìˆ˜ìˆëŠ”, ì •ì§í•œ, ì„±ì‹¤í•œ, ì‹ ë¢°í• ìˆ˜ìˆëŠ”
**ë§Œì¡±**: ì¬ë°©ë¬¸í•˜ëŠ”, ë§Œì¡±ìŠ¤ëŸ¬ìš´, ì¶”ì²œí•˜ëŠ”, ë¯¿ê³ ê°€ëŠ”

---

## ğŸš« ê¸ˆì§€ í‚¤ì›Œë“œ ê²€ì¦ (ë§¤ìš° ì¤‘ìš”!)

### ì—…ì¢… í˜¼ë™ ë°©ì§€ (ì ˆëŒ€ ê·œì¹™)
- **ì¹´í˜**: "ë§›ì§‘", "ì•¼ì‹", "íšŒì‹", "ìˆ ", "ì•ˆì£¼" ë“± ì‹ë‹¹/ìˆ ì§‘ í‚¤ì›Œë“œ ì ˆëŒ€ ê¸ˆì§€!
- **í•œì˜ì›/ë³‘ì›**: "ë§›ìˆëŠ”", "ê³ ì†Œí•œ" ë“± ìŒì‹ ê´€ë ¨ í‚¤ì›Œë“œ ê¸ˆì§€
- **ê° ì—…ì¢…**: í•´ë‹¹ ì—…ì¢…ì— ë§ì§€ ì•ŠëŠ” í‚¤ì›Œë“œ ì‚¬ìš© ì ˆëŒ€ ê¸ˆì§€

### í—ˆìœ„ ì •ë³´ ì°¨ë‹¨
- í…ìŠ¤íŠ¸ì— ì—†ëŠ” ë‚´ìš© ì¶”ì¸¡ ê¸ˆì§€
- ê³¼ì¥ëœ í‘œí˜„ ("ìµœê³ ", "1ë“±", "ìœ ëª…í•œ") ì‚¬ìš© ìì œ
- ê²€ì¦ ë¶ˆê°€ëŠ¥í•œ ë‚´ìš© ê¸ˆì§€

---

## ğŸ“¤ ì‘ë‹µ í˜•ì‹ (JSON - ì •í™•íˆ ì§€ì¼œì£¼ì„¸ìš”!)

{
  "ì—…ì¢…": "ê°ì§€ëœ ì—…ì¢…ëª… (14ê°œ ì¤‘ ì •í™•íˆ 1ê°œ)",
  "íŠ¹ë³„ê°•ì ": ["ê°•ì 1", "ê°•ì 2", "ê°•ì 3", "ê°•ì 4", "ê°•ì 5"],
  "ì¶”ì²œí‚¤ì›Œë“œ": ["í‚¤ì›Œë“œ1", "í‚¤ì›Œë“œ2", ..., "í‚¤ì›Œë“œ20"],
  "ì°¨ë‹¨ëœí‚¤ì›Œë“œ": []
}

---

## âš ï¸ í•µì‹¬ ì§€ì¹¨ (ë°˜ë“œì‹œ ì¤€ìˆ˜!)

1. **ì—…ì¢… ê°ì§€ ì •í™•ë„**: í•µì‹¬ í‚¤ì›Œë“œ ìš°ì„  í™•ì¸ â†’ ì—…ì¢… íŒë³„
2. **ì¹´í˜ vs ì‹ë‹¹ ì—„ê²© êµ¬ë¶„**: "ì¹´í˜", "ì»¤í”¼" ìˆìœ¼ë©´ â†’ ë¬´ì¡°ê±´ ì¹´í˜!
3. **ìì—°ìŠ¤ëŸ¬ìš´ í•œêµ­ì–´**: "~í•œ", "~ìˆëŠ”", "~ì¢‹ì€" í˜•íƒœ ì‚¬ìš©
4. **ì •í™•íˆ 20ê°œ**: ë°˜ë“œì‹œ 20ê°œ í‚¤ì›Œë“œ (ì¤‘ë³µ ì ˆëŒ€ ê¸ˆì§€!)
5. **ì—…ì¢…ë³„ íŠ¹í™”**: ìœ„ ê°€ì´ë“œì˜ í•´ë‹¹ ì—…ì¢… í‚¤ì›Œë“œë§Œ ì‚¬ìš©
6. **íŠ¹ë³„ ê°•ì **: í…ìŠ¤íŠ¸ì—ì„œ ëª…í™•íˆ í™•ì¸ë˜ëŠ” ë‚´ìš©ë§Œ (ìµœëŒ€ 5ê°œ)
7. **í˜•ìš©ì‚¬ í˜•íƒœ**: "ë§›ìˆëŠ”", "ì¹œì ˆí•œ" ë“± í˜•ìš©ì‚¬ í˜•íƒœë¡œ í†µì¼

**ì˜ˆì‹œ - ì¹´í˜ í‚¤ì›Œë“œ (ì¢‹ì€ ì˜ˆ)**:
["ì»¤í”¼ë§›ì¢‹ì€", "ì›ë‘ì¢‹ì€", "ë””ì €íŠ¸ë§›ìˆëŠ”", "ê°ì„±ìˆëŠ”", "ì•„ëŠ‘í•œ", "ì¸ìŠ¤íƒ€ê°ì„±", "ì‘ì—…í•˜ê¸°ì¢‹ì€", "ì¼€ì´í¬ë§›ì§‘", "ë¶„ìœ„ê¸°ì¢‹ì€", "í¸ì•ˆí•œ", "ì¡°ìš©í•œ", "ì¸í…Œë¦¬ì–´ì˜ˆìœ", "ë°”ë¦¬ìŠ¤íƒ€ì‹¤ë ¥ì¢‹ì€", "ë¹µë§›ìˆëŠ”", "ì¾Œì í•œ", "ì„¸ë ¨ëœ", "ì¹´í˜ë§›ì§‘", "íë§ë˜ëŠ”", "ê°ì„±ì¹´í˜", "ìˆ¨ì€ì¹´í˜"]

**ì˜ˆì‹œ - ì¹´í˜ í‚¤ì›Œë“œ (ë‚˜ìœ ì˜ˆ - ì ˆëŒ€ ê¸ˆì§€!)**:
["ë§›ì§‘", "ì•¼ì‹ë§›ì§‘", "íšŒì‹ì¥ì†Œ", "ìˆ ë§›ì¢‹ì€", "ì•ˆì£¼ë§›ìˆëŠ”"] â† ì‹ë‹¹/ìˆ ì§‘ í‚¤ì›Œë“œ ì‚¬ìš© ê¸ˆì§€!
"""

    def recommend_keywords(self, business_info: str, count: int = 20) -> Dict:
        """
        ì—…ì²´ ì •ë³´ë¥¼ ë¶„ì„í•˜ì—¬ í‚¤ì›Œë“œ ì¶”ì²œ

        Args:
            business_info: ì—…ì²´ ì†Œê°œê¸€
            count: ì¶”ì²œí•  í‚¤ì›Œë“œ ê°œìˆ˜

        Returns:
            {
                "ì—…ì¢…": str,
                "íŠ¹ë³„ê°•ì ": List[str],
                "ì¶”ì²œí‚¤ì›Œë“œ": List[str],
                "ì¶”ì²œê°œìˆ˜": int,
                "ì°¨ë‹¨ëœí‚¤ì›Œë“œ": List[str]
            }
        """

        try:
            # GPT-4o-mini API í˜¸ì¶œ
            response = self.client.chat.completions.create(
                model="gpt-4o-mini",
                messages=[
                    {"role": "system", "content": self.system_prompt},
                    {"role": "user", "content": f"ë‹¤ìŒ ì—…ì²´ ì •ë³´ë¥¼ ë¶„ì„í•˜ì—¬ ì—…ì¢…, íŠ¹ë³„ê°•ì , ì¶”ì²œ í‚¤ì›Œë“œ {count}ê°œë¥¼ JSON í˜•ì‹ìœ¼ë¡œ ë°˜í™˜í•´ì£¼ì„¸ìš”:\n\n{business_info}"}
                ],
                temperature=0.3,  # 0.7 â†’ 0.3ìœ¼ë¡œ ë‚®ì¶¤ (ë” ì¼ê´€ëœ ì‘ë‹µ)
                max_tokens=1500,  # 1000 â†’ 1500ìœ¼ë¡œ ì¦ê°€
                response_format={"type": "json_object"}
            )

            # ì‘ë‹µ íŒŒì‹±
            result_text = response.choices[0].message.content
            result = json.loads(result_text)

            # ê²°ê³¼ ê²€ì¦ ë° ë³´ì •
            if "ì—…ì¢…" not in result:
                result["ì—…ì¢…"] = "ë²”ìš©"

            if "íŠ¹ë³„ê°•ì " not in result or not isinstance(result["íŠ¹ë³„ê°•ì "], list):
                result["íŠ¹ë³„ê°•ì "] = []

            if "ì¶”ì²œí‚¤ì›Œë“œ" not in result or not isinstance(result["ì¶”ì²œí‚¤ì›Œë“œ"], list):
                result["ì¶”ì²œí‚¤ì›Œë“œ"] = []

            if "ì°¨ë‹¨ëœí‚¤ì›Œë“œ" not in result:
                result["ì°¨ë‹¨ëœí‚¤ì›Œë“œ"] = []

            # í‚¤ì›Œë“œ ê°œìˆ˜ ì œí•œ
            result["ì¶”ì²œí‚¤ì›Œë“œ"] = result["ì¶”ì²œí‚¤ì›Œë“œ"][:count]
            result["ì¶”ì²œê°œìˆ˜"] = len(result["ì¶”ì²œí‚¤ì›Œë“œ"])

            return result

        except Exception as e:
            # ì—ëŸ¬ ë°œìƒ ì‹œ ê¸°ë³¸ ì‘ë‹µ ë°˜í™˜
            return {
                "ì—…ì¢…": "ë²”ìš©",
                "íŠ¹ë³„ê°•ì ": [],
                "ì¶”ì²œí‚¤ì›Œë“œ": ["ì¹œì ˆí•œ", "ì¢‹ì€", "ê¹¨ë—í•œ", "ì „ë¬¸ì ì¸", "ë§Œì¡±ìŠ¤ëŸ¬ìš´"],
                "ì¶”ì²œê°œìˆ˜": 5,
                "ì°¨ë‹¨ëœí‚¤ì›Œë“œ": [],
                "error": str(e)
            }

    def get_usage_cost(self, input_tokens: int, output_tokens: int) -> float:
        """
        API ì‚¬ìš© ë¹„ìš© ê³„ì‚° (USD)

        Args:
            input_tokens: ì…ë ¥ í† í° ìˆ˜
            output_tokens: ì¶œë ¥ í† í° ìˆ˜

        Returns:
            ë¹„ìš© (USD)
        """
        input_cost = (input_tokens / 1_000_000) * 0.15  # $0.15 per 1M tokens
        output_cost = (output_tokens / 1_000_000) * 0.60  # $0.60 per 1M tokens
        return input_cost + output_cost


# í…ŒìŠ¤íŠ¸ ì½”ë“œ
if __name__ == "__main__":
    # API í‚¤ëŠ” í™˜ê²½ë³€ìˆ˜ì—ì„œ ê°€ì ¸ì˜´
    recommender = AIKeywordRecommender()

    # í…ŒìŠ¤íŠ¸ ì—…ì²´ ì •ë³´
    test_info = """
    'ëª¸ê³¼ ë§ˆìŒì„ í•¨ê»˜ ì¹˜ìœ í•˜ëŠ”' ë‚˜ë¹„í•œì˜ì›ì€ ë‚´ì›í•˜ì‹œëŠ” ëª¨ë“  ë¶„ë“¤ì˜ ê±´ê°•ê³¼ í–‰ë³µì„ ê¸°ì›í•©ë‹ˆë‹¤.
    ì„¸ë°€í•œ ì§„ë‹¨ê³¼ ì²´ì§ˆë³„ ì›ì¸ íŒŒì•…ì„ í†µí•´ ê°œì¸ë³„ ë§ì¶¤ì§„ë£Œë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.
    ë§¤ì£¼ ì›”~ëª© ë°¤ 8ì‹œ 30ë¶„ê¹Œì§€ ì•¼ê°„ì§„ë£Œí•˜ëŠ” í•œì˜ì›ì…ë‹ˆë‹¤.

    <ì§„ë£Œê³¼ëª©>
    1. í•œë°©ë¹„ë§Œí´ë¦¬ë‹‰ - ë‹¤ì´ì–´íŠ¸ ì „ë¬¸
    2. í•œë°© íƒˆëª¨í´ë¦¬ë‹‰ - PDRN ì•½ì¹¨ ë„ì…
    3. í•œë°©í”¼ë¶€í´ë¦¬ë‹‰ - ì—¬ë“œë¦„, ì•„í† í”¼ ì¹˜ë£Œ
    """

    result = recommender.recommend_keywords(test_info)

    print("\n" + "="*60)
    print("ğŸ¤– AI í‚¤ì›Œë“œ ì¶”ì²œ ê²°ê³¼ (ì •êµí™”ëœ í”„ë¡¬í”„íŠ¸)")
    print("="*60)
    print(f"\nğŸ“ ì—…ì¢…: {result['ì—…ì¢…']}")
    print(f"\nâ­ íŠ¹ë³„ ê°•ì : {', '.join(result['íŠ¹ë³„ê°•ì '])}")
    print(f"\nâœ… ì¶”ì²œ í‚¤ì›Œë“œ ({result['ì¶”ì²œê°œìˆ˜']}ê°œ):")
    for i, keyword in enumerate(result['ì¶”ì²œí‚¤ì›Œë“œ'], 1):
        print(f"   {i}. {keyword}")

    if result.get('ì°¨ë‹¨ëœí‚¤ì›Œë“œ'):
        print(f"\nğŸš« ì°¨ë‹¨ëœ í‚¤ì›Œë“œ: {', '.join(result['ì°¨ë‹¨ëœí‚¤ì›Œë“œ'])}")

    print("\n" + "="*60)
